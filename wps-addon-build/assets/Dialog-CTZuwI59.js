import{_ as k,c as p,a as e,d as v,t as f,w as d,e as I,v as m,f as g,b as r,n as P,r as w,g as G,u as T,h as U,i as x,j as q,o as u}from"./index-CelDLeeQ.js";const V={setup(){const i=w({apiUrl:"",apiKey:"",models:{defaultModel:"gpt-4.1",customModel:"",continuationModel:"",proofreadingModel:"",polishingModel:"",qaModel:"",summarizationModel:""},options:{maxTokens:2e3,temperature:.7}}),o=T(),b=G(()=>{const a=o.path==="/help";return console.log(`计算isHelp: 路径=${o.path}, 结果=${a}`),a}),t=w(!1),s=w(""),c=w(""),l=()=>{t.value=!t.value};U(()=>o.path,a=>{console.log("路由路径变化:",a)}),x(()=>{if(console.log("Dialog组件挂载, 当前路由完整信息:",{path:o.path,fullPath:o.fullPath,name:o.name,params:o.params,query:o.query}),console.log("是否显示帮助:",b.value),window.Application&&window.Application.PluginStorage){const a=window.Application.PluginStorage.getItem("aiConfig");if(a)try{const n=JSON.parse(a);i.value={...i.value,...n,models:{...i.value.models,...n.models},options:{...i.value.options,...n.options}},console.log("成功加载配置:",i.value)}catch(n){console.error("配置加载失败",n)}else console.log("未找到已保存的配置")}else console.warn("PluginStorage不可用")});const C=async()=>{if(!i.value.apiUrl){window.Application.Alert("请填写API地址");return}s.value="testing",c.value="正在测试连接...";let a=i.value.models.defaultModel;if(a==="custom"&&i.value.models.customModel)a=i.value.models.customModel;else if(a==="custom"&&!i.value.models.customModel){s.value="error",c.value="请填写自定义模型名称";return}try{q.updateConfig({apiUrl:i.value.apiUrl,apiKey:i.value.apiKey,models:{defaultModel:a}}),await q.testConnection(),s.value="success",c.value="连接成功！"}catch(n){s.value="error",c.value=`连接失败: ${n.message}`}},S=()=>{if(console.log("开始保存配置...",i.value),!i.value.apiUrl){console.warn("API地址为空，中止保存"),window.Application.Alert("请填写API地址");return}if(i.value.models.defaultModel==="custom"&&!i.value.models.customModel){console.warn("自定义模型名称为空，中止保存"),window.Application.Alert("请填写自定义模型名称");return}const a=JSON.parse(JSON.stringify(i.value));if(console.log("配置对象深度复制完成"),a.models.defaultModel==="custom"){console.log("检测到自定义模型",{defaultModel:a.models.defaultModel,customModel:a.models.customModel});const n=a.models.customModel;a.models.defaultModel=n,console.log("自定义模型已设置为默认模型",{defaultModel:a.models.defaultModel,customModel:a.models.customModel})}if(window.Application&&window.Application.PluginStorage)try{const n=JSON.stringify(a);console.log("准备保存配置:",n),window.Application.PluginStorage.setItem("aiConfig",n),console.log("配置已保存到本地存储");const A=window.Application.PluginStorage.getItem("aiConfig");if(A){const y=JSON.parse(A);console.log("验证保存的配置:",y)}s.value="success",c.value="配置已成功保存!",setTimeout(()=>{window.Application.Alert("配置已成功保存"),M()},1e3)}catch(n){console.error("配置保存失败",n),s.value="error",c.value="配置保存失败: "+n.message,window.Application.Alert("配置保存失败: "+n.message)}else console.error("PluginStorage不可用，无法保存配置"),s.value="error",c.value="无法访问存储，配置保存失败",window.Application.Alert("无法访问存储，配置保存失败")},M=()=>{try{console.log("正在关闭对话框..."),window.Application&&typeof window.Application.CloseDialog=="function"?(window.Application.CloseDialog(),console.log("对话框已关闭")):(console.warn("CloseDialog方法不可用，尝试备选方法"),window.close&&window.close())}catch(a){console.error("关闭对话框失败:",a)}};return{config:i,advancedOpen:t,testStatus:s,testMessage:c,isHelp:b,toggleAdvanced:l,testConnection:C,saveConfig:S,closeDialog:M}}},D={class:"dialog-container"},O={class:"dialog-header"},Q={key:0,class:"dialog-content settings-content"},B={class:"form-group"},N={class:"form-group"},z={class:"form-group"},K={key:0,class:"form-group"},H={class:"test-connection-group"},J={class:"advanced-settings"},j={key:0,class:"advanced-content"},E={class:"form-group"},L={class:"form-group"},R={class:"range-value"},W={class:"form-group"},F={class:"sub-setting"},X={class:"sub-setting"},Y={class:"sub-setting"},Z={class:"sub-setting"},h={class:"sub-setting"},_={class:"dialog-footer"},$={class:"action-buttons"},oo={key:0,class:"save-status success"},eo={key:1,class:"dialog-content help-content"},to={class:"dialog-footer"};function lo(i,o,b,t,s,c){return u(),p("div",D,[e("div",O,[e("h2",null,"WPS AI助手 - "+f(t.isHelp?"帮助":"设置"),1)]),t.isHelp?v("",!0):(u(),p("div",Q,[e("div",B,[o[16]||(o[16]=e("label",{for:"apiUrl"},[I("API 地址 "),e("span",{class:"required"},"*")],-1)),d(e("input",{type:"text",id:"apiUrl","onUpdate:modelValue":o[0]||(o[0]=l=>t.config.apiUrl=l),class:"full-border-input",placeholder:"请输入AI服务API地址，例如: https://api.openai.com"},null,512),[[m,t.config.apiUrl]]),o[17]||(o[17]=e("div",{class:"help-text"},"支持OpenAI API格式的服务，如OpenAI、Azure OpenAI、私有部署模型等",-1))]),e("div",N,[o[18]||(o[18]=e("label",{for:"apiKey"},"API 密钥",-1)),d(e("input",{type:"password",id:"apiKey","onUpdate:modelValue":o[1]||(o[1]=l=>t.config.apiKey=l),class:"full-border-input",placeholder:"请输入API密钥（可选，部分API服务不需要）"},null,512),[[m,t.config.apiKey]])]),e("div",z,[o[20]||(o[20]=e("label",{for:"model"},"默认模型",-1)),d(e("select",{id:"model","onUpdate:modelValue":o[2]||(o[2]=l=>t.config.models.defaultModel=l),class:"full-border-input"},o[19]||(o[19]=[r('<optgroup label="OpenAI" data-v-ecce0d21><option value="gpt-4.1" data-v-ecce0d21>GPT-4.1</option><option value="gpt-4.5-preview" data-v-ecce0d21>GPT-4.5 Preview</option><option value="gpt-4" data-v-ecce0d21>GPT-4</option><option value="gpt-4-turbo" data-v-ecce0d21>GPT-4 Turbo</option><option value="gpt-3.5-turbo" data-v-ecce0d21>GPT-3.5 Turbo</option></optgroup><optgroup label="Anthropic" data-v-ecce0d21><option value="claude-3-7-sonnet" data-v-ecce0d21>Claude 3.7 Sonnet</option><option value="claude-3-5-sonnet" data-v-ecce0d21>Claude 3.5 Sonnet</option><option value="claude-3-opus" data-v-ecce0d21>Claude 3 Opus</option></optgroup><optgroup label="Google" data-v-ecce0d21><option value="gemini-2.5-pro-preview-03-25" data-v-ecce0d21>Gemini 2.5 Pro Preview</option><option value="gemini-2.5-flash-preview-04-17" data-v-ecce0d21>Gemini 2.5 Flash Preview</option><option value="gemini-1.5-pro" data-v-ecce0d21>Gemini 1.5 Pro</option></optgroup><optgroup label="混合" data-v-ecce0d21><option value="o4-mini" data-v-ecce0d21>O4-mini</option><option value="o1" data-v-ecce0d21>O1</option><option value="grok-3-beta" data-v-ecce0d21>Grok-3-beta</option></optgroup><optgroup label="DeepSeek" data-v-ecce0d21><option value="deepseek-r1" data-v-ecce0d21>DeepSeek-R1</option><option value="deepseek-v3-0324" data-v-ecce0d21>DeepSeek-V3-0324</option></optgroup><optgroup label="阿里云" data-v-ecce0d21><option value="qwen3-235b-a22b" data-v-ecce0d21>Qwen3-235B-A22B</option><option value="qwen3-30b-a3b" data-v-ecce0d21>Qwen3-30B-A3B</option><option value="qwen3-32b" data-v-ecce0d21>Qwen3-32B</option><option value="qwen3-14b" data-v-ecce0d21>Qwen3-14B</option><option value="qwq-32b" data-v-ecce0d21>QWQ-32b</option><option value="qwen2.5-72b-instruct" data-v-ecce0d21>Qwen2.5-72B-Instruct</option><option value="qwen2.5-32b-instruct" data-v-ecce0d21>Qwen2.5-32B-Instruct</option><option value="qwen2.5-14b-instruct" data-v-ecce0d21>Qwen2.5-14B-Instruct</option></optgroup><optgroup label="其他" data-v-ecce0d21><option value="custom" data-v-ecce0d21>自定义...</option></optgroup>',7)]),512),[[g,t.config.models.defaultModel]])]),t.config.models.defaultModel==="custom"?(u(),p("div",K,[o[21]||(o[21]=e("label",{for:"customModel"},"自定义模型名称",-1)),d(e("input",{type:"text",id:"customModel","onUpdate:modelValue":o[3]||(o[3]=l=>t.config.models.customModel=l),class:"full-border-input",placeholder:"请输入模型名称"},null,512),[[m,t.config.models.customModel]])])):v("",!0),e("div",H,[e("button",{onClick:o[4]||(o[4]=(...l)=>t.testConnection&&t.testConnection(...l)),class:"btn-test"},"检测连通性"),t.testStatus?(u(),p("span",{key:0,class:P(["test-status",t.testStatus==="success"?"success":"error"])},f(t.testMessage),3)):v("",!0)]),e("div",J,[e("div",{class:"section-title",onClick:o[5]||(o[5]=(...l)=>t.toggleAdvanced&&t.toggleAdvanced(...l))},[o[23]||(o[23]=e("span",{class:"title-text"},"高级设置",-1)),e("span",{class:P(["toggle-icon",{expanded:t.advancedOpen}])},o[22]||(o[22]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M7 10L12 15L17 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),2)]),t.advancedOpen?(u(),p("div",j,[e("div",E,[o[24]||(o[24]=e("label",{for:"maxTokens"},"最大输出令牌数",-1)),d(e("input",{type:"number",id:"maxTokens","onUpdate:modelValue":o[6]||(o[6]=l=>t.config.options.maxTokens=l),min:"100",max:"32000",class:"full-border-input"},null,512),[[m,t.config.options.maxTokens,void 0,{number:!0}]])]),e("div",L,[o[25]||(o[25]=e("label",{for:"temperature"},"随机性 (0.0-1.0)",-1)),d(e("input",{type:"range",id:"temperature","onUpdate:modelValue":o[7]||(o[7]=l=>t.config.options.temperature=l),min:"0",max:"1",step:"0.1",class:"full-border-input"},null,512),[[m,t.config.options.temperature,void 0,{number:!0}]]),e("div",R,f(t.config.options.temperature),1)]),e("div",W,[o[36]||(o[36]=e("label",null,"特定功能模型设置",-1)),e("div",F,[o[27]||(o[27]=e("label",{for:"continuationModel"},"文本续写",-1)),d(e("select",{id:"continuationModel","onUpdate:modelValue":o[8]||(o[8]=l=>t.config.models.continuationModel=l),class:"full-border-input"},o[26]||(o[26]=[r('<option value="" data-v-ecce0d21>使用默认模型</option><option value="gpt-4.1" data-v-ecce0d21>GPT-4.1</option><option value="claude-3-7-sonnet" data-v-ecce0d21>Claude 3.7 Sonnet</option><option value="gemini-2.5-pro-preview-03-25" data-v-ecce0d21>Gemini 2.5 Pro Preview</option><option value="qwen3-32b" data-v-ecce0d21>Qwen3-32b</option>',5)]),512),[[g,t.config.models.continuationModel]])]),e("div",X,[o[29]||(o[29]=e("label",{for:"proofreadingModel"},"文本校对",-1)),d(e("select",{id:"proofreadingModel","onUpdate:modelValue":o[9]||(o[9]=l=>t.config.models.proofreadingModel=l),class:"full-border-input"},o[28]||(o[28]=[r('<option value="" data-v-ecce0d21>使用默认模型</option><option value="gpt-4.1" data-v-ecce0d21>GPT-4.1</option><option value="claude-3-7-sonnet" data-v-ecce0d21>Claude 3.7 Sonnet</option><option value="gemini-2.5-pro-preview-03-25" data-v-ecce0d21>Gemini 2.5 Pro Preview</option><option value="qwen3-32b" data-v-ecce0d21>Qwen3-32b</option>',5)]),512),[[g,t.config.models.proofreadingModel]])]),e("div",Y,[o[31]||(o[31]=e("label",{for:"polishingModel"},"文本润色",-1)),d(e("select",{id:"polishingModel","onUpdate:modelValue":o[10]||(o[10]=l=>t.config.models.polishingModel=l),class:"full-border-input"},o[30]||(o[30]=[r('<option value="" data-v-ecce0d21>使用默认模型</option><option value="gpt-4.1" data-v-ecce0d21>GPT-4.1</option><option value="claude-3-7-sonnet" data-v-ecce0d21>Claude 3.7 Sonnet</option><option value="gemini-2.5-pro-preview-03-25" data-v-ecce0d21>Gemini 2.5 Pro Preview</option><option value="qwen3-32b" data-v-ecce0d21>Qwen3-32b</option>',5)]),512),[[g,t.config.models.polishingModel]])]),e("div",Z,[o[33]||(o[33]=e("label",{for:"qaModel"},"文档问答",-1)),d(e("select",{id:"qaModel","onUpdate:modelValue":o[11]||(o[11]=l=>t.config.models.qaModel=l),class:"full-border-input"},o[32]||(o[32]=[r('<option value="" data-v-ecce0d21>使用默认模型</option><option value="gpt-4.1" data-v-ecce0d21>GPT-4.1</option><option value="claude-3-7-sonnet" data-v-ecce0d21>Claude 3.7 Sonnet</option><option value="gemini-2.5-pro-preview-03-25" data-v-ecce0d21>Gemini 2.5 Pro Preview</option><option value="qwen3-32b" data-v-ecce0d21>Qwen3-32b</option>',5)]),512),[[g,t.config.models.qaModel]])]),e("div",h,[o[35]||(o[35]=e("label",{for:"summarizationModel"},"全文总结",-1)),d(e("select",{id:"summarizationModel","onUpdate:modelValue":o[12]||(o[12]=l=>t.config.models.summarizationModel=l),class:"full-border-input"},o[34]||(o[34]=[r('<option value="" data-v-ecce0d21>使用默认模型</option><option value="gpt-4.1" data-v-ecce0d21>GPT-4.1</option><option value="claude-3-7-sonnet" data-v-ecce0d21>Claude 3.7 Sonnet</option><option value="gemini-2.5-pro-preview-03-25" data-v-ecce0d21>Gemini 2.5 Pro Preview</option><option value="qwen3-32b" data-v-ecce0d21>Qwen3-32b</option>',5)]),512),[[g,t.config.models.summarizationModel]])])])])):v("",!0)]),e("div",_,[e("div",$,[e("button",{onClick:o[13]||(o[13]=(...l)=>t.saveConfig&&t.saveConfig(...l)),class:"btn-primary"},"保存"),t.testStatus==="success"&&t.testMessage.includes("已成功保存")?(u(),p("span",oo,f(t.testMessage),1)):v("",!0),e("button",{onClick:o[14]||(o[14]=(...l)=>t.closeDialog&&t.closeDialog(...l)),class:"btn-secondary"},"取消")])])])),t.isHelp?(u(),p("div",eo,[o[37]||(o[37]=r('<div class="help-section" data-v-ecce0d21><h3 data-v-ecce0d21>主要功能</h3><ul data-v-ecce0d21><li data-v-ecce0d21><strong data-v-ecce0d21>文本续写</strong>：根据选中的文本或光标所在段落，智能续写内容。 </li><li data-v-ecce0d21><strong data-v-ecce0d21>文本校对</strong>：检查并修正选中文本或光标所在段落中的错误。 </li><li data-v-ecce0d21><strong data-v-ecce0d21>文本润色</strong>：优化选中文本或光标所在段落的表达，使其更加专业流畅。 </li><li data-v-ecce0d21><strong data-v-ecce0d21>文档问答</strong>：基于当前文档内容回答问题，支持选取部分内容或全文。 </li><li data-v-ecce0d21><strong data-v-ecce0d21>全文总结</strong>：为整个文档或选中内容生成摘要。 </li></ul></div><div class="help-section" data-v-ecce0d21><h3 data-v-ecce0d21>使用方法</h3><ol data-v-ecce0d21><li data-v-ecce0d21>首先点击&quot;设置&quot;按钮配置AI接口信息</li><li data-v-ecce0d21>文本操作（续写/校对/润色）： <ul data-v-ecce0d21><li data-v-ecce0d21>选择需要处理的文本（或定位光标到段落中）</li><li data-v-ecce0d21>点击对应功能按钮</li><li data-v-ecce0d21>处理完成后，修改结果会显示在原文后</li><li data-v-ecce0d21>按Enter接受修改，删除旧内容</li></ul></li><li data-v-ecce0d21>文档问答： <ul data-v-ecce0d21><li data-v-ecce0d21>点击&quot;文档问答&quot;按钮，打开侧边栏</li><li data-v-ecce0d21>在输入框中输入问题，按回车或点击&quot;提问&quot;</li><li data-v-ecce0d21>AI将基于文档内容回答问题</li></ul></li><li data-v-ecce0d21>全文总结： <ul data-v-ecce0d21><li data-v-ecce0d21>点击&quot;全文总结&quot;按钮，打开侧边栏</li><li data-v-ecce0d21>如有选中内容，将生成该内容的摘要；否则生成全文摘要</li><li data-v-ecce0d21>点击&quot;重新生成&quot;可刷新摘要结果</li></ul></li></ol></div><div class="help-section" data-v-ecce0d21><h3 data-v-ecce0d21>常见问题</h3><div class="qa-item" data-v-ecce0d21><div class="question" data-v-ecce0d21>API设置无法保存？</div><div class="answer" data-v-ecce0d21>请确保填写了必要的API地址，如使用自定义模型需填写模型名称。</div></div><div class="qa-item" data-v-ecce0d21><div class="question" data-v-ecce0d21>功能按钮点击无反应？</div><div class="answer" data-v-ecce0d21>请先完成API设置，确保API连通性正常。</div></div><div class="qa-item" data-v-ecce0d21><div class="question" data-v-ecce0d21>处理结果不正确？</div><div class="answer" data-v-ecce0d21>尝试使用不同的模型，或提供更多上下文信息。</div></div></div>',3)),e("div",to,[e("button",{onClick:o[15]||(o[15]=(...l)=>t.closeDialog&&t.closeDialog(...l)),class:"btn-close"},"关闭")])])):v("",!0)])}const io=k(V,[["render",lo],["__scopeId","data-v-ecce0d21"]]);export{io as default};
