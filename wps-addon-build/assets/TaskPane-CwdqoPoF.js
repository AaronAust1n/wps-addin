import{_ as K,c as u,a as s,t as v,d as D,F as j,k as J,w as O,v as G,l as X,m as Y,r as d,g as Z,i as $,j as c,p as z,o as m,n as ee}from"./index-CelDLeeQ.js";const ne={setup(){const i=d("å‡†å¤‡å°±ç»ª"),o=d(""),f=d(""),t=d([]),y=d(!1),h=d("å…¨æ–‡æ€»ç»“"),a=d(""),w=d(!1),C=d(""),k=d(!1),R=Z(()=>o.value==="qa"?"WPS AIæ–‡æ¡£é—®ç­”":o.value==="summary"?"WPS AIæ–‡æ¡£æ‘˜è¦":"WPS AIåŠ©æ‰‹"),U=()=>{const e=new URL(window.location.href),n=new URLSearchParams(e.search||e.hash.split("?")[1]);return{function:n.get("function"),direct:n.get("direct")==="true",selection:n.get("selection")==="true",refresh:n.get("refresh")}},g=()=>{try{const e=window.Application.ActiveDocument.Range;return e?e.Text:(window.Application.Alert("æœªé€‰æ‹©ä»»ä½•æ–‡æœ¬"),null)}catch(e){return console.error("è·å–é€‰ä¸­æ–‡æœ¬å¤±è´¥:",e),window.Application.Alert("è·å–é€‰ä¸­æ–‡æœ¬å¤±è´¥: "+e.message),null}},T=()=>{try{const e=window.Application.ActiveDocument.Range;return e?e.Paragraphs(1).Range.Text:null}catch(e){return console.error("è·å–æ®µè½å¤±è´¥:",e),null}},I=()=>{try{const e=window.Application.ActiveDocument;return e?e.Range().Text:(window.Application.Alert("æ— æ³•è·å–æ–‡æ¡£å†…å®¹"),null)}catch(e){return console.error("è·å–æ–‡æ¡£å†…å®¹å¤±è´¥:",e),window.Application.Alert("è·å–æ–‡æ¡£å†…å®¹å¤±è´¥: "+e.message),null}},p=e=>{try{const n=window.Application.ActiveDocument.Range;return n.Collapse(),n.InsertAfter(e),!0}catch(n){return console.error("æ’å…¥æ–‡æœ¬å¤±è´¥:",n),window.Application.Alert("æ’å…¥æ–‡æœ¬å¤±è´¥: "+n.message),!1}},A=()=>{if(window.Application&&window.Application.PluginStorage){const e=window.Application.PluginStorage.getItem("aiConfig");if(e)try{return JSON.parse(e)}catch(n){console.error("é…ç½®åŠ è½½å¤±è´¥",n)}}return null},b=()=>{const e=A();return!e||!e.apiUrl?(window.Application.Alert("è¯·å…ˆé…ç½®APIè®¾ç½®"),handleSettings(),!1):!0},M=async()=>{if(!b())return;const e=g();if(e)x("continue",e);else{const n=T();if(!n){window.Application.Alert("è¯·å…ˆé€‰æ‹©æ–‡æœ¬æˆ–å°†å…‰æ ‡æ”¾ç½®åœ¨æ®µè½ä¸­");return}S("continue",n)}},H=async()=>{if(!b())return;const e=g();if(e)x("proofread",e);else{const n=T();if(!n){window.Application.Alert("è¯·å…ˆé€‰æ‹©æ–‡æœ¬æˆ–å°†å…‰æ ‡æ”¾ç½®åœ¨æ®µè½ä¸­");return}S("proofread",n)}},B=async()=>{if(!b())return;const e=g();if(e)x("polish",e);else{const n=T();if(!n){window.Application.Alert("è¯·å…ˆé€‰æ‹©æ–‡æœ¬æˆ–å°†å…‰æ ‡æ”¾ç½®åœ¨æ®µè½ä¸­");return}S("polish",n)}},x=async(e,n)=>{i.value="æ­£åœ¨å¤„ç†æ–‡æœ¬...";try{const r=A();c.updateConfig(r);let l="";switch(e){case"continue":l=await c.continueText(n),p(l),i.value="æ–‡æœ¬ç»­å†™å®Œæˆ";break;case"proofread":l=await c.proofreadText(n),p(`
`+l),i.value="æ–‡æœ¬æ ¡å¯¹å®Œæˆï¼Œè¯·æŒ‰Enterç¡®è®¤ä¿®æ”¹";break;case"polish":l=await c.polishText(n),p(`
`+l),i.value="æ–‡æœ¬æ¶¦è‰²å®Œæˆï¼Œè¯·æŒ‰Enterç¡®è®¤ä¿®æ”¹";break}}catch(r){i.value="æ“ä½œå¤±è´¥: "+r.message}},S=async(e,n)=>{i.value="æ­£åœ¨å¤„ç†æ®µè½...";try{const r=A();c.updateConfig(r);let l="";switch(e){case"continue":l=await c.continueText(n),p(l),i.value="æ–‡æœ¬ç»­å†™å®Œæˆ";break;case"proofread":l=await c.proofreadText(n),p(`
`+l),i.value="æ–‡æœ¬æ ¡å¯¹å®Œæˆï¼Œè¯·æŒ‰Enterç¡®è®¤ä¿®æ”¹";break;case"polish":l=await c.polishText(n),p(`
`+l),i.value="æ–‡æœ¬æ¶¦è‰²å®Œæˆï¼Œè¯·æŒ‰Enterç¡®è®¤ä¿®æ”¹";break}}catch(r){i.value="æ“ä½œå¤±è´¥: "+r.message}},L=()=>{b()&&(o.value="qa",i.value="æ–‡æ¡£é—®ç­”å·²å¯åŠ¨")},N=()=>{if(console.log("æäº¤é—®é¢˜æŒ‰é’®è¢«ç‚¹å‡»"),!f.value.trim()||y.value){console.log("é—®é¢˜ä¸ºç©ºæˆ–æ­£åœ¨å¤„ç†ä¸­ï¼Œå¿½ç•¥æäº¤");return}E()},E=async()=>{if(console.log("æ‰§è¡ŒaskQuestionå‡½æ•°"),!f.value.trim()){console.log("é—®é¢˜ä¸ºç©ºï¼Œæ”¾å¼ƒå¤„ç†");return}console.log("å¼€å§‹å¤„ç†é—®é¢˜:",f.value),t.value.push({role:"user",content:f.value});const e=f.value;f.value="",y.value=!0,i.value="æ­£åœ¨å¤„ç†é—®é¢˜...";try{console.log("è·å–æ–‡æ¡£å†…å®¹...");const n=g();console.log(`é€‰ä¸­æ–‡æœ¬çŠ¶æ€: ${n?"æœ‰é€‰ä¸­æ–‡æœ¬, é•¿åº¦:"+n.length:"æ— é€‰ä¸­æ–‡æœ¬"}`);let r;if(n&&n.trim()?(r=n,console.log("ä½¿ç”¨é€‰ä¸­æ–‡æœ¬è¿›è¡Œé—®ç­”")):(r=I(),console.log("ä½¿ç”¨å…¨æ–‡è¿›è¡Œé—®ç­”, æ–‡æœ¬é•¿åº¦:",r?r.length:0)),!r)throw console.error("æ— æ³•è·å–æ–‡æ¡£å†…å®¹"),new Error("æ— æ³•è·å–æ–‡æ¡£å†…å®¹");console.log("æ›´æ–°APIé…ç½®...");const l=A();if(!l)throw console.error("APIé…ç½®æœªæ‰¾åˆ°"),new Error("æ— æ³•è·å–APIé…ç½®ï¼Œè¯·å…ˆåœ¨è®¾ç½®ä¸­é…ç½®API");c.updateConfig(l),console.log("å‘é€é—®ç­”è¯·æ±‚åˆ°API:",l.apiUrl);const P=await c.documentQA(r,e);if(console.log("é—®ç­”å®Œæˆï¼Œç­”æ¡ˆé•¿åº¦:",P?P.length:0),!P)throw console.error("APIè¿”å›ç©ºç­”æ¡ˆ"),new Error("è·å–åˆ°çš„å›ç­”ä¸ºç©º");t.value.push({role:"assistant",content:P}),console.log("å°è¯•æ»šåŠ¨åˆ°å¯¹è¯å†å²åº•éƒ¨"),await z();const _=document.querySelector(".qa-history");_?(console.log("æ»šåŠ¨åˆ°åº•éƒ¨"),_.scrollTop=_.scrollHeight):console.warn("æœªæ‰¾åˆ°.qa-historyå…ƒç´ ï¼Œæ— æ³•æ»šåŠ¨"),i.value="é—®é¢˜å›ç­”å®Œæˆ",console.log("å°è¯•å°†ç„¦ç‚¹æ”¾å›è¾“å…¥æ¡†"),await z(),document.querySelector(".qa-input")&&document.querySelector(".qa-input").focus()}catch(n){console.error("æ–‡æ¡£é—®ç­”å¤„ç†å¤±è´¥:",n),t.value.push({role:"assistant",content:"å›ç­”å¤±è´¥: "+n.message}),i.value="é—®ç­”å¤±è´¥: "+n.message}finally{y.value=!1}},V=async()=>{if(!b())return;o.value="summary";const e=g();e&&e.trim()?h.value="é€‰ä¸­å†…å®¹æ‘˜è¦":h.value="å…¨æ–‡æ€»ç»“",q()},q=async()=>{w.value=!0,C.value="",a.value="",i.value="æ­£åœ¨ç”Ÿæˆæ‘˜è¦...";try{const e=g(),n=e&&e.trim()?e:I();if(!n)throw new Error("æ— æ³•è·å–æ–‡æ¡£å†…å®¹");const r=A();c.updateConfig(r),a.value=await c.summarizeDocument(n),i.value="æ‘˜è¦ç”Ÿæˆå®Œæˆ"}catch(e){console.error("æ‘˜è¦ç”Ÿæˆå¤±è´¥:",e),C.value="æ‘˜è¦ç”Ÿæˆå¤±è´¥: "+e.message,i.value="æ‘˜è¦ç”Ÿæˆå¤±è´¥: "+e.message}finally{w.value=!1}},W=()=>{if(a.value)try{navigator.clipboard.writeText(a.value).then(()=>{i.value="æ‘˜è¦å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",setTimeout(()=>{i.value="å‡†å¤‡å°±ç»ª"},2e3)}).catch(e=>{console.error("å¤åˆ¶åˆ°å‰ªè´´æ¿å¤±è´¥:",e),i.value="å¤åˆ¶å¤±è´¥: "+e.message,Q(a.value)})}catch(e){console.error("å¤åˆ¶æ‘˜è¦å¤±è´¥:",e),i.value="å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶",Q(a.value)}},Q=e=>{try{const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-9999px",document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),i.value="æ‘˜è¦å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",setTimeout(()=>{i.value="å‡†å¤‡å°±ç»ª"},2e3)}catch(n){console.error("å¤‡ç”¨å¤åˆ¶æ–¹æ³•å¤±è´¥:",n),i.value="å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶"}},F=()=>{k.value&&window.parent&&typeof window.parent.closeTaskPane=="function"?window.parent.closeTaskPane():(o.value="",i.value="å‡†å¤‡å°±ç»ª")};return $(()=>{const e=U();k.value=e.direct||!1,e.function==="qa"?(o.value="qa",i.value="æ–‡æ¡£é—®ç­”å·²å¯åŠ¨"):e.function==="summary"&&(o.value="summary",h.value=e.selection?"é€‰ä¸­å†…å®¹æ‘˜è¦":"å…¨æ–‡æ€»ç»“",k.value&&q())}),{statusMessage:i,activePanel:o,question:f,qaHistory:t,isProcessing:y,summaryTitle:h,summaryContent:a,isSummarizing:w,summaryError:C,isDirect:k,panelTitle:R,handleContinueText:M,handleProofread:H,handlePolish:B,handleDocumentQA:L,handleSummarizeDoc:V,askQuestion:E,submitQuestion:N,refreshSummary:q,copySummary:W,closePanel:F}}},oe={class:"taskpane-container"},te={class:"taskpane-header"},se={class:"taskpane-content"},ae={key:0,class:"function-panel"},ie={key:1,class:"sidebar-panel"},le={class:"sidebar-header"},re={class:"qa-history",ref:"qaHistoryRef"},ce={class:"qa-role"},ue={class:"qa-content"},de={class:"qa-input-area"},me=["disabled"],ve=["disabled"],fe={key:2,class:"sidebar-panel"},ge={class:"sidebar-header"},pe={class:"summary-content"},ye={key:0,class:"loading-indicator"},he={key:1,class:"error-message"},we={key:2,class:"summary-text"},Ae={key:3,class:"empty-message"},be={class:"sidebar-footer"},ke=["disabled"],Pe=["disabled"],Ce={class:"taskpane-footer"},Te={class:"status-bar"};function xe(i,o,f,t,y,h){return m(),u("div",oe,[s("div",te,[s("h2",null,v(t.panelTitle),1)]),s("div",se,[t.isDirect?D("",!0):(m(),u("div",ae,[s("div",{class:"function-item",onClick:o[0]||(o[0]=(...a)=>t.handleContinueText&&t.handleContinueText(...a))},o[12]||(o[12]=[s("div",{class:"icon"},"ğŸ“",-1),s("div",{class:"title"},"æ–‡æœ¬ç»­å†™",-1),s("div",{class:"description"},"æ ¹æ®ä¸Šä¸‹æ–‡æ™ºèƒ½ç»­å†™æ–‡æ¡£å†…å®¹",-1)])),s("div",{class:"function-item",onClick:o[1]||(o[1]=(...a)=>t.handleProofread&&t.handleProofread(...a))},o[13]||(o[13]=[s("div",{class:"icon"},"âœ“",-1),s("div",{class:"title"},"æ–‡æœ¬æ ¡å¯¹",-1),s("div",{class:"description"},"æ£€æŸ¥å¹¶ä¿®æ­£æ–‡æ¡£ä¸­çš„é”™è¯¯",-1)])),s("div",{class:"function-item",onClick:o[2]||(o[2]=(...a)=>t.handlePolish&&t.handlePolish(...a))},o[14]||(o[14]=[s("div",{class:"icon"},"âœ¨",-1),s("div",{class:"title"},"æ–‡æœ¬æ¶¦è‰²",-1),s("div",{class:"description"},"æ”¹è¿›æ–‡æ¡£è¡¨è¾¾ï¼Œä½¿æ–‡ç« æ›´ä¸“ä¸š",-1)])),s("div",{class:"function-item",onClick:o[3]||(o[3]=(...a)=>t.handleDocumentQA&&t.handleDocumentQA(...a))},o[15]||(o[15]=[s("div",{class:"icon"},"â“",-1),s("div",{class:"title"},"æ–‡æ¡£é—®ç­”",-1),s("div",{class:"description"},"åŸºäºæ–‡æ¡£å†…å®¹å›ç­”é—®é¢˜",-1)])),s("div",{class:"function-item",onClick:o[4]||(o[4]=(...a)=>t.handleSummarizeDoc&&t.handleSummarizeDoc(...a))},o[16]||(o[16]=[s("div",{class:"icon"},"ğŸ“š",-1),s("div",{class:"title"},"å…¨æ–‡æ€»ç»“",-1),s("div",{class:"description"},"åˆ†ææ•´ä¸ªæ–‡æ¡£å¹¶ç”Ÿæˆæ€»ç»“",-1)]))])),t.activePanel==="qa"?(m(),u("div",ie,[s("div",le,[o[17]||(o[17]=s("h3",null,"æ–‡æ¡£é—®ç­”",-1)),s("button",{onClick:o[5]||(o[5]=(...a)=>t.closePanel&&t.closePanel(...a)),class:"close-btn"},"Ã—")]),s("div",re,[(m(!0),u(j,null,J(t.qaHistory,(a,w)=>(m(),u("div",{key:w,class:ee(["qa-item",a.role])},[s("div",ce,v(a.role==="user"?"é—®é¢˜":"å›ç­”"),1),s("div",ue,v(a.content),1)],2))),128))],512),s("div",de,[O(s("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=a=>t.question=a),onKeydown:o[7]||(o[7]=X(Y((...a)=>t.submitQuestion&&t.submitQuestion(...a),["prevent"]),["enter"])),placeholder:"è¯·è¾“å…¥é—®é¢˜...",class:"qa-input",disabled:t.isProcessing,ref:"questionInput"},null,40,me),[[G,t.question]]),s("button",{onClick:o[8]||(o[8]=(...a)=>t.submitQuestion&&t.submitQuestion(...a)),class:"qa-submit",disabled:t.isProcessing||!t.question.trim()},v(t.isProcessing?"å¤„ç†ä¸­...":"æé—®"),9,ve)])])):D("",!0),t.activePanel==="summary"?(m(),u("div",fe,[s("div",ge,[s("h3",null,v(t.summaryTitle),1),s("button",{onClick:o[9]||(o[9]=(...a)=>t.closePanel&&t.closePanel(...a)),class:"close-btn"},"Ã—")]),s("div",pe,[t.isSummarizing?(m(),u("div",ye,o[18]||(o[18]=[s("div",{class:"loading-spinner"},null,-1),s("div",{class:"loading-text"},"æ­£åœ¨ç”Ÿæˆæ‘˜è¦ï¼Œè¯·ç¨å€™...",-1)]))):t.summaryError?(m(),u("div",he,v(t.summaryError),1)):t.summaryContent?(m(),u("div",we,v(t.summaryContent),1)):(m(),u("div",Ae,' ç‚¹å‡»"é‡æ–°ç”Ÿæˆ"æŒ‰é’®å¼€å§‹ç”Ÿæˆæ‘˜è¦ '))]),s("div",be,[s("button",{onClick:o[10]||(o[10]=(...a)=>t.refreshSummary&&t.refreshSummary(...a)),class:"refresh-btn",disabled:t.isSummarizing},v(t.isSummarizing?"ç”Ÿæˆä¸­...":"é‡æ–°ç”Ÿæˆ"),9,ke),s("button",{onClick:o[11]||(o[11]=(...a)=>t.copySummary&&t.copySummary(...a)),class:"copy-btn",disabled:!t.summaryContent}," å¤åˆ¶å†…å®¹ ",8,Pe)])])):D("",!0)]),s("div",Ce,[s("div",Te,[s("span",null,v(t.statusMessage),1)])])])}const qe=K(ne,[["render",xe],["__scopeId","data-v-06f3c22b"]]);export{qe as default};
