import{_ as b,c as a,a as e,F as w,k as m,r as A,i as k,o as l,t as d}from"./index-CelDLeeQ.js";const C={setup(){const r=A([]),s=t=>{console.log("安全警告:",t);try{typeof window.Application.Alert=="function"?window.Application.Alert(t):alert(t)}catch(o){console.error("所有警告方法都失败:",o);try{alert(t)}catch(u){console.error("原生alert也失败:",u)}}};k(()=>{h()});const h=()=>{try{if(window.Application&&window.Application.PluginStorage){const t=window.Application.PluginStorage.getItem("aiHistory");t?(r.value=JSON.parse(t),console.log("历史记录加载成功，共",r.value.length,"条记录")):console.log("未找到历史记录")}}catch(t){console.error("加载历史记录失败:",t)}},n=()=>{if(window.confirm("确定要清空所有历史记录吗？"))try{window.Application&&window.Application.PluginStorage&&(window.Application.PluginStorage.setItem("aiHistory","[]"),r.value=[],console.log("历史记录已清空"))}catch(t){console.error("清空历史记录失败:",t)}},_=t=>{const o=new Date(t);return`${o.getFullYear()}-${c(o.getMonth()+1)}-${c(o.getDate())} ${c(o.getHours())}:${c(o.getMinutes())}`},c=t=>t<10?"0"+t:t,i=t=>({continue:"文本续写",proofread:"文本校对",polish:"文本润色",qa:"文档问答",summarize:"文档摘要"})[t]||"未知操作",y=(t,o)=>t?t.length>o?t.substring(0,o)+"...":t:"",p=t=>{try{navigator.clipboard.writeText(t).then(()=>{s("已复制到剪贴板")}).catch(o=>{console.error("复制失败:",o),f(t)})}catch(o){console.error("复制功能不可用:",o),f(t)}},f=t=>{try{const o=document.createElement("textarea");o.value=t,o.style.position="fixed",document.body.appendChild(o),o.focus(),o.select();const u=document.execCommand("copy");document.body.removeChild(o),s(u?"已复制到剪贴板":"复制失败，请手动复制")}catch(o){console.error("后备复制方法失败:",o),s("复制功能不可用")}},v=t=>{s(`即将重新${i(t.type)}，请在文档中选择位置`),g()},g=()=>{window.Application&&window.Application.CloseDialog()};return{history:r,formatTime:_,getOperationName:i,truncateText:y,copyToClipboard:p,reuse:v,clearHistory:n,closeHistory:g}}},x={class:"history-container"},H={class:"history-content"},S={key:0,class:"empty-history"},T={key:1,class:"history-list"},M={class:"history-time"},P={class:"history-type"},D={class:"history-text"},I={class:"input-text"},N={class:"text-content"},B={class:"output-text"},E={class:"text-content"},F={class:"history-actions"},O=["onClick"],q=["onClick"],z={class:"history-footer"},J=["disabled"];function V(r,s,h,n,_,c){return l(),a("div",x,[s[4]||(s[4]=e("div",{class:"history-header"},[e("h2",null,"WPS AI助手 - 历史记录")],-1)),e("div",H,[n.history.length===0?(l(),a("div",S," 暂无历史记录 ")):(l(),a("div",T,[(l(!0),a(w,null,m(n.history,(i,y)=>(l(),a("div",{key:y,class:"history-item"},[e("div",M,d(n.formatTime(i.timestamp)),1),e("div",P,d(n.getOperationName(i.type)),1),e("div",D,[e("div",I,[s[2]||(s[2]=e("div",{class:"text-label"},"输入:",-1)),e("div",N,d(n.truncateText(i.input,100)),1)]),e("div",B,[s[3]||(s[3]=e("div",{class:"text-label"},"输出:",-1)),e("div",E,d(n.truncateText(i.output,150)),1)])]),e("div",F,[e("button",{onClick:p=>n.copyToClipboard(i.output),class:"action-btn copy-btn"},"复制结果",8,O),e("button",{onClick:p=>n.reuse(i),class:"action-btn reuse-btn"},"重新使用",8,q)])]))),128))]))]),e("div",z,[e("button",{onClick:s[0]||(s[0]=(...i)=>n.clearHistory&&n.clearHistory(...i)),class:"btn btn-warning",disabled:n.history.length===0},"清空历史",8,J),e("button",{onClick:s[1]||(s[1]=(...i)=>n.closeHistory&&n.closeHistory(...i)),class:"btn btn-primary"},"关闭")])])}const Y=b(C,[["render",V],["__scopeId","data-v-b636e3ab"]]);export{Y as default};
